DICA NMAP NSE 
- `cd /usr/share/nmap/scripts: ls | grep smtp` (lista todos scripts sobre determinado serviço)

Enumerando HTTP
- `nc -v alvo.com.br 80`
- `HEAD / HTTP/1.0 (para ver versão do server)
    -host: alvo.com.br
  ou 
    -OPTIONS /tets HTTP/1.0  (para ver metodos permitidos)
    
Enumerando HTTP'S
- `openssl s_client -quiet -connect alvo.com.br:443`


Identificando WAF
- `wafw00f alvo.com.br`
- `nmap –script=http-waf-fingerprint testsite.com`
- `sqlmap -u http://alvo.com.br --identify-waf`


Enumerando FTP 
- `nmap -v -sV -p21,2121 -Pn --open alvoip/24 -oG ftp`
- `nc -vn 172.16.1.245 21 (para pegar o banner versao do ftp)`


Enumerando Netbios/SMB - Windows  
- `cd /usr/share/nmap/scripts: nmap --scripts=smb-enum-shares.nse IPALVO`
- `nbtstat -A ip.alvowindows (ver compartilhamentos)`
     -net view \\ip.alvowindows  (ver info dos shares)
       -net use \\ip.alvowindows "" /u:"" (null session) (ou com usuario= /u:admin etc)
       -net use (ai lista as conexoes)

Enumerando com scripts nmap - Windows
  ls /usr/share/nmap/scripts/smb
- `nmap -v --script=smb-os-discovery ip.alvo`
- `nmap -v --script=smb-vuln-ms* ip.alvo (scan todas vuln windows)`


Canivete suiço Scan Windows 
*apt install crackmapexec 
- `crackmapexec smb ip.alvo/24 (vai scanear a rede windows)`
*ou pode ser passado uma credencial valida  
- `crackmapexec smb ip.alvo/24 -u admin -p 'P@ss@12'`
*pode passa o -L no final (comando acima mais -L) para ver todos os modulos


Brute Force SMB - Windows 
   criar wordlist de senha em determinado diretorio,e dentro dele acessar via cmd 
   C:\>for /f %i in (wordlist.txt) do net use \\ip.alvo %i /u:USUARIO A SER TESTADO
    Para testar usuario e senha criar wordlist com 2 campos
     C:\>for /f "tokens=1,2" %i in (wordlistUsernPass.txt) do net use \\ip.alvo %j /u:%i


Enumerando Netbios/SMB - Linux
- `nbtscan -r ip.alvo/24  (scan toda rede linux)`
- `smbclient -L \\ip.alvo -N (scan toda rede para encontrar file share via smb)`
- `smbclient -L \\ip.alvo -N -U administrator (ou outro usuario)`
- `smbclient //ip.alvo/_DOCS -N (para acessar o compartilhamento)`
(Dica problema versão smb: smbclient -V 'acima da 4.11' usar:--option='client min protocol=NT1' no final do comando, 
ex:smbclient -L \\ip.alvo -N --option='client min protocol=NT1')


Enumerando RPC - Linux
- `rpcclient -U "" -N ip.alvo   (conecta-se ao alvo atraves do protocolo rpc)`
- `enumdomusers (enumerar usuarios)`
- `queryuser root (infos do usuario)`
- `netshareenumall (enumerar compartilhamentos)`


Enumerando Linux Automatico
- `enum4linux -A ip.alvo (-A enumera todas infos do host, -U usuarios, -S os shares)`
- `enum4linux -a ip.alvo -u administrator -p (infos com usuario)`


Enumerando POP3
- `nmap --open -sS -p 110 -Pn ip.alvo-faixa (scan faixa rede encontrar porta email 110)`
- `nc -v ip.alvo 110`
- `telnet ip.alvo 110`
       USER camila
       PASS ca123456
       LIST   
       RETR 1   (para entrar na msg de email selecionada)
