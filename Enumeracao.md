DICA NMAP NSE 
- `cd /usr/share/nmap/scripts: ls | grep smtp` (lista todos scripts sobre determinado serviço)

Enumerando HTTP
- `nc -v alvo.com.br 80`
- `HEAD / HTTP/1.0 (para ver versão do server)
    -host: alvo.com.br
  ou 
    -OPTIONS /tets HTTP/1.0  (para ver metodos permitidos)
    
Enumerando HTTP'S
- `openssl s_client -quiet -connect alvo.com.br:443`


Identificando WAF
- `wafw00f alvo.com.br`
- `nmap –script=http-waf-fingerprint testsite.com`
- `sqlmap -u http://alvo.com.br --identify-waf`


Enumerando FTP 
- `nmap -v -sV -p21,2121 -Pn --open alvoip/24 -oG ftp`
- `nc -vn 172.16.1.245 21 (para pegar o banner versao do ftp)`


Enumerando Netbios/SMB - Windows  
- `cd /usr/share/nmap/scripts: nmap --scripts=smb-enum-shares.nse IPALVO`
- `nbtstat -A ip.alvowindows (ver compartilhamentos)`
     -net view \\ip.alvowindows  (ver info dos shares)
       -net use \\ip.alvowindows "" /u:"" (null session) (ou com usuario= /u:admin etc)
       -net use (ai lista as conexoes)

Enumerando com scripts nmap - Windows
  ls /usr/share/nmap/scripts/smb
- `nmap -v --script=smb-os-discovery ip.alvo`
- `nmap -v --script=smb-vuln-ms* ip.alvo (scan todas vuln windows)`


Canivete suiço Scan Windows 
*apt install crackmapexec 
- `crackmapexec smb ip.alvo/24 (vai scanear a rede windows)`
*ou pode ser passado uma credencial valida  
- `crackmapexec smb ip.alvo/24 -u admin -p 'P@ss@12'`
*pode passa o -L no final (comando acima mais -L) para ver todos os modulos


Enumerando Netbios/SMB - Linux
- `nbtscan -r ip.alvo/24  (scan toda rede linux)`
- `smbclient -L \\ip.alvo -N (scan toda rede para encontrar file share via smb)`
- `smbclient -L \\ip.alvo -N -U administrator (ou outro usuario)`
- `smbclient //ip.alvo/_DOCS -N (para acessar o compartilhamento)`
(Dica problema versão smb: smbclient -V 'acima da 4.11' usar:--option='client min protocol=NT1' no final do comando, 
ex:smbclient -L \\ip.alvo -N --option='client min protocol=NT1')


Enumerando RPC - Linux
- `rpcclient -U "" -N ip.alvo   (conecta-se ao alvo atraves do protocolo rpc)`
- `enumdomusers (enumerar usuarios)`
- `queryuser root (infos do usuario)`
- `netshareenumall (enumerar compartilhamentos)`


Enumerando Linux Automatico
- `enum4linux -A ip.alvo (-A enumera todas infos do host, -U usuarios, -S os shares)`
- `enum4linux -a ip.alvo -u administrator -p (infos com usuario)`


Enumerando POP3
- `nmap --open -sS -p 110 -Pn ip.alvo-faixa (scan faixa rede encontrar porta email 110)`
- `nc -v ip.alvo 110`
- `telnet ip.alvo 110` depois realizar interação


Enumerando SMTP
- `nmap --open -sS -p 25 -Pn ip.alvo/24`
- `nc -v ip.alvo 25` depois realizar interação 
       HELO teste   (ou HELP para listar comandos)
       VRFY admin (ou outro usuario retorno 252 user existe)    
       
       
Enumerando NFS 
- `nmap --open -sS -p 2049 -Pn ip.alvo/24`
- `rpcinfo -p ip.alvo | grep nfs`
- `showmount -e ip.alvo`
- `mkdir /tmp/nfs`
- `mount -t nfs -o nfsvers=2 ip.alvo:/ /tmp/nfs`
- `cd /tmp/nfs`


Enumerando MySQL
- `nmap --open -sS -p 3306 -Pn 172.16.1.0/24`
- `mysql -h 172.16.1.5 -u mysql ou root (-u usuario para tentar autenticar no mysql)`
    
    
Enumerando SNMP 
- `nmap -sVU -p161 -Pn 172.16.1.4 172.16.1.247` 
- `onesixtyone (para varrer e encontrar comunity, usar padrao ou criar propria wordlist basica de pesquisa)`
     valores MIBS: 1.3.6.1.4.1.77.1.2.25 contas de usuarios / 1.3.6.1.2.1.6.13.1.3 portas tcp 
- `snmpwalk -c public -v1 172.16.1.4 1.3.6.1.4.1.77.1.2.25  (vai listar usuarios)` 
- `snmpwalk -c public -v1 172.16.1.4 (todas infos da maquina,porem sem interpretacao das mibs, instalar pack)` 
- `apt install snmp-mibs-downloader (para interpretar as mibs com os nomes delas)` 
         -echo "" > /etc/snmp/snmp.conf (aplicar config para os softwares lerem as mibs)


Alterar info SNMP
- `snmp-check 172.16.1.4 -c public`


